name: "Simple Feature Workflow"
description: "End-to-end feature implementation using just natural language instructions"

query_template: |
  I need to implement this feature: {{query}}
  
  Please help me build this feature from requirements understanding to git push.

steps:
  - message: "understand_requirements"
    description: "Understand and clarify feature requirements"
    content: |
      I need to implement this feature: {{query}}
      
      Before proceeding, I need to make sure I fully understand what needs to be built.
      
      Based on your description, please:
      1. Summarize your understanding of the feature requirements
      2. Identify any ambiguities or missing information
      3. Outline the core functionality that needs to be implemented
      4. Define the expected behavior and acceptance criteria
      5. Suggest a good name for the git branch to use
    store_response: "requirements_analysis"
    
  - wait: "confirm_requirements"
    wait_message: "Review the requirements analysis. Press Enter to continue with codebase investigation, or provide clarifications..."

  - shell: "explore_codebase"
    description: "Explore the codebase structure"
    command: "find . -type f -not -path '*/\\.*' -not -path '*/node_modules/*' -not -path '*/target/*' | sort | head -50"
    store_output: "file_structure"

  - shell: "examine_content"
    description: "Examine key files"
    command: "find . -type f -name 'main.*' -o -name 'index.*' -o -name 'app.*' | head -3 | xargs cat 2>/dev/null || echo 'No key files found'"
    store_output: "key_files"

  - message: "analyze_codebase"
    description: "Analyze the codebase structure"
    content: |
      Based on the requirements, I'm analyzing the codebase to understand where and how to implement the feature.
      
      Here's the file structure:
      ```
      {{file_structure}}
      ```
      
      And content of some key files:
      ```
      {{key_files}}
      ```
      
      Please analyze this codebase and:
      1. Identify the overall project structure and technology stack
      2. Determine where the new feature should be implemented
      3. List the specific files we'll need to modify or create
      4. Note any important patterns or conventions to follow
    store_response: "codebase_analysis"

  - message: "implementation_plan"
    description: "Create a detailed implementation plan"
    content: |
      Now that I've analyzed the codebase, I need a detailed plan for implementing the feature.
      
      Feature to implement: {{query}}
      
      Please create a step-by-step implementation plan that includes:
      1. The specific files to create or modify
      2. The changes needed in each file
      3. Any new dependencies or third-party libraries we should use
      4. How to test the implementation
      5. Potential challenges and how to address them
    store_response: "implementation_plan"

  - shell: "create_branch"
    description: "Create a git branch for the feature"
    command: "git branch | grep '*' | awk '{print $2}' | xargs echo 'Current branch:'"
    store_output: "branch_info"

  - message: "implement_feature"
    description: "Implement the feature"
    content: |
      Based on the implementation plan, please generate the complete code for this feature.
      
      For each file that needs to be created or modified, provide:
      - The full file path
      - Complete file content or specific changes needed
      - Comments explaining the implementation
      
      Please ensure the code follows the project's existing style and patterns.
    store_response: "implementation_code"

  - wait: "review_code"
    wait_message: "Review the implementation code. Press Enter when ready to proceed with building and testing..."

  - shell: "build_test"
    description: "Test if the code builds"
    command: "echo 'This is where we would build the project to test the implementation. In a real workflow, this would run the appropriate build command.'"
    store_output: "build_result"

  - message: "create_tests"
    description: "Create tests for the feature"
    content: |
      Please create appropriate tests for the implemented feature.
      
      Include:
      - Unit tests for individual components
      - Integration tests if applicable
      - Test cases that cover the main functionality and edge cases
      
      Provide the complete test code for each test file needed.
    store_response: "test_code"

  - message: "commit_message"
    description: "Generate commit message"
    content: |
      I need a descriptive commit message for this feature implementation.
      
      Feature: {{query}}
      
      Please provide:
      1. A concise subject line (50 chars or less)
      2. A more detailed explanation of the changes
      3. Any references to issue numbers if applicable
      4. Any breaking changes or special notes
    store_response: "commit_details"

  - output: "completion_summary"
    description: "Show completion summary"
    content: |
      # Feature Implementation Complete! ðŸŽ‰
      
      ## Implementation Summary
      
      ### Feature Requirements
      {{requirements_analysis}}
      
      ### Implementation Approach
      {{implementation_plan}}
      
      ### Implementation Details
      The code has been provided for all necessary files.
      
      ### Tests
      Tests have been created to verify the functionality.
      
      ### Commit Message
      {{commit_details}}
      
      ## Next Steps
      
      1. Apply the code changes to your project files
      2. Run the build and tests to verify everything works
      3. Commit with the provided commit message
      4. Push your changes
      
      Would you like assistance with any of these steps?