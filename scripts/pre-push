#!/bin/bash
#
# This pre-push hook runs tests before allowing a push to the remote.
# This ensures that code pushed to the repository has passed all local tests.
#
# To install this hook, run the following command from the root of the repository:
# ln -s -f ../../scripts/pre-push .git/hooks/pre-push

echo "Running pre-push hook: Executing linter and tests..."

# Run the linter. If it fails, the script will exit with a non-zero status,
# which will prevent the push.
echo "Running linter..."
cargo clippy -- -D warnings

# Run the tests. If they fail, the script will exit with a non-zero status,
# which will prevent the push.
echo "Running tests..."
cargo test --all

# If the tests pass, the script will exit with a zero status, and the push will proceed.
echo "Linter and tests passed. Proceeding with push."