{% extends "base.html" %}

{% block content %}
<div class="py-8 px-4 max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-900 mb-8">Termineer User Manual</h1>
    
    <div class="space-y-12">
        <!-- Getting Started Section -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Getting Started</h2>
                <p class="text-gray-700 mb-6">
                    Termineer is a self-directing AI coding engineer that operates from your terminal. 
                    To get started, you'll need to configure your API keys and understand the basic configuration options.
                </p>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">API Keys</h3>
                <p class="text-gray-700 mb-3">Termineer supports multiple LLM providers. You'll need at least one API key to use the application.</p>
                <div class="space-y-4 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">ANTHROPIC_API_KEY</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            Required for using Claude models like 'claude-3-opus', 'claude-3-sonnet', and 'claude-3-haiku'.
                            <a href="https://console.anthropic.com/settings/keys" class="text-primary-600 hover:text-primary-800" target="_blank">
                                Get your API key from Anthropic
                            </a>
                        </p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">GOOGLE_API_KEY</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            Serves two purposes: (1) For web search functionality and (2) For using Google's Gemini models like 'gemini-1.5-pro'.
                            <a href="https://console.cloud.google.com/apis/credentials" class="text-primary-600 hover:text-primary-800" target="_blank">
                                Get your API key from Google Cloud
                            </a>
                        </p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">OPENROUTER_API_KEY</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            Required for accessing models through OpenRouter, which provides a unified API for various models including GPT-4o, Claude, and more.
                            <a href="https://openrouter.ai/keys" class="text-primary-600 hover:text-primary-800" target="_blank">
                                Get your API key from OpenRouter
                            </a>
                        </p>
                        <p class="text-gray-700 text-sm mt-2">
                            <strong>Optional settings:</strong>
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm mt-1">
                            <li><code>OPENROUTER_SITE_URL</code> - Your application's URL (for request ranking)</li>
                            <li><code>OPENROUTER_SITE_NAME</code> - Your application's name (for request ranking)</li>
                        </ul>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">DEEPSEEK_API_KEY</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            Required for using DeepSeek models like 'deepseek-chat' and 'deepseek-reasoner'.
                            <a href="https://platform.deepseek.com/" class="text-primary-600 hover:text-primary-800" target="_blank">
                                Get your API key from DeepSeek
                            </a>
                        </p>
                    </div>
                </div>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">Configuration Methods</h3>
                
                <div class="space-y-4">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">.env File Support</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            Termineer supports loading configuration from .env files. Create a .env file in your project directory with your API keys:
                        </p>
                        <div class="code-block mt-2 mb-2">
                            <code>ANTHROPIC_API_KEY=sk-ant-your-key-here
GOOGLE_API_KEY=your-google-key-here</code>
                        </div>
                        <p class="text-gray-700 text-sm mt-1">
                            Termineer checks the following locations for .env files:
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm mt-1">
                            <li>Current directory (./.env)</li>
                            <li>The env subdirectory (./env/.env)</li>
                            <li>Parent directory (../.env)</li>
                            <li>Home directory (~/.env)</li>
                        </ul>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900">Environment Variables</h4>
                        <p class="text-gray-700 text-sm mt-1">
                            You can also set these as environment variables directly:
                        </p>
                        <div class="code-block mt-2">
                            <code>export ANTHROPIC_API_KEY=sk-ant-your-key-here
export GOOGLE_API_KEY=your-google-key-here</code>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Advanced Configuration Section -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Advanced Configuration</h2>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">.termineer Directory</h3>
                <p class="text-gray-700 mb-4">
                    Termineer uses a special directory structure for project-specific configuration. You can create a <code>.termineer</code> directory
                    in your project root to customize behavior.
                </p>
                
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h4 class="font-medium text-gray-900">Project Information</h4>
                    <p class="text-gray-700 text-sm mt-1">
                        Create an <code>info</code> file in the <code>.termineer</code> directory with project information. This will be loaded automatically at the start of each agent conversation.
                    </p>
                    <div class="code-block mt-2">
                        <code># Project information:
# My Awesome Project
This is a description of my project that Termineer will use to understand the context.

## Technologies
- Python 3.9
- Django
- PostgreSQL

## Architecture
The project follows a standard MVC architecture with:
- models/ - Database models and business logic
- views/ - Request handlers and response formatting
- templates/ - HTML templates for rendering
- static/ - CSS, JavaScript, and other static assets

## API Endpoints
- GET /api/users - List all users
- POST /api/users - Create a new user
- GET /api/users/:id - Get a specific user</code>
                    </div>
                    <p class="text-gray-700 text-sm mt-3">
                        The content should follow Markdown formatting guidelines. Termineer will automatically include your current working directory and prefix this information with "Project information:".
                    </p>
                </div>
                
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h4 class="font-medium text-gray-900">Automatic File Inclusion</h4>
                    <p class="text-gray-700 text-sm mt-1">
                        Create an <code>autoinclude</code> file in the <code>.termineer</code> directory to automatically include files in your context. Each line is treated as a glob pattern:
                    </p>
                    <div class="code-block mt-2">
                        <code># Include key configuration files
config/*.json
README.md

# Include important source files
src/main.rs
src/config.rs

# Include all API-related files
src/api/*.rs

# Comments start with #
# Empty lines are ignored</code>
                    </div>
                    <p class="text-gray-700 text-sm mt-3">
                        Files matching these patterns will be automatically loaded and added to the agent's context at startup. Binary files and certain extensions (.exe, .jpg, etc.) are automatically excluded. Use this feature to give your agent immediate access to important project files.
                    </p>
                </div>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">Model Context Protocol (MCP) - Experimental</h3>
                <p class="text-gray-700 mb-4">
                    MCP is an experimental feature that allows Termineer to interact with specialized tools and services through a protocol.
                    This enables advanced functionalities beyond the built-in tools. <strong>Note:</strong> Termineer currently only supports standard input/output MCP servers.
                </p>
                
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-medium text-gray-900">Configuring MCP Servers</h4>
                    <p class="text-gray-700 text-sm mt-1">
                        MCP servers are configured in one or both of these locations:
                    </p>
                    <ul class="list-disc list-inside text-gray-700 text-sm mt-1 mb-2">
                        <li>Home directory: <code>~/.termineer/mcp/config.json</code></li>
                        <li>Local project directory: <code>.termineer/config.json</code></li>
                    </ul>
                    <p class="text-gray-700 text-sm mt-1">
                        Configurations from both locations are merged, with local settings taking precedence. This allows for system-wide defaults with project-specific overrides.
                    </p>
                    <p class="text-gray-700 text-sm mt-1">Example MCP configurations:</p>
                    
                    <p class="text-gray-700 text-sm mt-3 font-medium">Home config (~/.termineer/mcp/config.json):</p>
                    <div class="code-block mt-1 mb-3">
                        <code>{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/username/Documents",
        "/Users/username/Downloads"
      ],
      "env": {
        "NODE_ENV": "production",
        "DEBUG": "mcp:*"
      }
    },
    "openapi": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-openapi"
      ],
      "env": {
        "PORT": "9001"
      }
    }
  }
}</code>
                    </div>
                    
                    <p class="text-gray-700 text-sm mt-3 font-medium">Project-specific config (.termineer/config.json):</p>
                    <div class="code-block mt-1">
                        <code>{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "./project-files",
        "/tmp/cache"
      ],
      "env": {
        "API_KEY": "project-specific-key"
      }
    },
    "project-tool": {
      "command": "./tools/my-custom-tool.js",
      "args": ["--serve"],
      "env": {
        "PORT": "9002"
      }
    }
  }
}</code>
                    </div>
                    
                    <p class="text-gray-700 text-sm mt-3 font-medium">Resulting merged configuration:</p>
                    <p class="text-gray-700 text-sm mt-1">
                      When both configurations exist, they'll be merged as follows:
                    </p>
                    <ul class="list-disc list-inside text-gray-700 text-sm mt-1 mb-2">
                      <li>"filesystem" from the project config overrides the home config (local takes precedence)</li>
                      <li>"openapi" from the home config is preserved</li>
                      <li>"project-tool" from the project config is added</li>
                    </ul>
                    
                    <p class="text-gray-700 text-sm mt-3">
                      <strong>Environment Variables:</strong> You can specify environment variables to be passed to MCP servers using the <code>env</code> field.
                      This is useful for setting API keys, debug modes, or other configuration without exposing them in command arguments.
                    </p>
                    
                    <p class="text-gray-700 text-sm mt-3">
                      <strong>Tip:</strong> Use the <code>.termineer/autoinclude</code> file (described in the Automatic File Inclusion section above) to include your MCP configuration files in the agent's context at startup. This can be helpful when working with custom MCP tools that require specific documentation or examples.
                    </p>
                </div>
            </div>
        </section>
        
        <!-- Command-Line Options Section -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Command-Line Options</h2>
                <p class="text-gray-700 mb-4">
                    Termineer supports various command-line options to customize behavior:
                </p>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead>
                            <tr class="bg-gray-50 border-b">
                                <th class="py-2 px-4 text-left text-gray-700 font-medium">Option</th>
                                <th class="py-2 px-4 text-left text-gray-700 font-medium">Description</th>
                                <th class="py-2 px-4 text-left text-gray-700 font-medium">Example</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y">
                            <tr>
                                <td class="py-2 px-4"><code>--model</code></td>
                                <td class="py-2 px-4">Specify the AI model to use</td>
                                <td class="py-2 px-4"><code>--model claude-3-haiku-20240307</code></td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>--kind</code></td>
                                <td class="py-2 px-4">Specify the agent kind/template</td>
                                <td class="py-2 px-4"><code>--kind researcher</code></td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>--grammar</code></td>
                                <td class="py-2 px-4">Specify the grammar type (xml, markdown)</td>
                                <td class="py-2 px-4"><code>--grammar xml</code></td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>--no-tools</code></td>
                                <td class="py-2 px-4">Disable tools</td>
                                <td class="py-2 px-4"><code>--no-tools</code></td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>--thinking-budget</code></td>
                                <td class="py-2 px-4">Set thinking token budget</td>
                                <td class="py-2 px-4"><code>--thinking-budget 16384</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 class="text-xl font-medium text-gray-900 mt-6 mb-3">Usage Examples</h3>
                <div class="space-y-3">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-gray-700 text-sm">Interactive mode (recommended for most uses):</p>
                        <div class="code-block mt-1">
                            <code>termineer</code>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-gray-700 text-sm">Single query mode with custom model:</p>
                        <div class="code-block mt-1">
                            <code>termineer --model claude-3-haiku-20240307 "Analyze this log file for errors"</code>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-gray-700 text-sm">Specialized agent kind:</p>
                        <div class="code-block mt-1">
                            <code>termineer --kind researcher "Find best practices for API security"</code>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- TUI Mode and Commands Section -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">TUI Mode and Commands</h2>
                <p class="text-gray-700 mb-4">
                    Termineer provides a rich Terminal User Interface (TUI) in interactive mode with keyboard shortcuts, command history, and special commands.
                </p>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">Command Modes</h3>
                <p class="text-gray-700 mb-4">
                    Termineer offers special command modes triggered by prefix characters:
                </p>
                
                <h4 class="font-medium text-gray-900 mb-2">Slash Commands Mode</h4>
                <p class="text-gray-700 text-sm mb-2">
                    Type a slash (/) followed by a command to perform special actions:
                </p>
                <div class="overflow-x-auto mb-6">
                    <table class="min-w-full bg-white">
                        <thead>
                            <tr class="bg-gray-50 border-b">
                                <th class="py-2 px-4 text-left text-gray-700 font-medium">Command</th>
                                <th class="py-2 px-4 text-left text-gray-700 font-medium">Description</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y">
                            <tr>
                                <td class="py-2 px-4"><code>/help</code></td>
                                <td class="py-2 px-4">Show available commands</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/exit</code> or <code>/quit</code></td>
                                <td class="py-2 px-4">Exit the application</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/interrupt</code></td>
                                <td class="py-2 px-4">Interrupt the current agent</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/model MODEL</code></td>
                                <td class="py-2 px-4">Set the model for the current agent (e.g., <code>/model claude-3-haiku-20240307</code>)</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/tools on|off</code></td>
                                <td class="py-2 px-4">Enable or disable tools</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/system TEXT</code></td>
                                <td class="py-2 px-4">Set the system prompt</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/reset</code></td>
                                <td class="py-2 px-4">Reset the conversation</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4"><code>/thinking NUMBER</code></td>
                                <td class="py-2 px-4">Set thinking budget in tokens (e.g., <code>/thinking 10000</code>)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h4 class="font-medium text-gray-900 mb-2">Agent Selection Mode</h4>
                <p class="text-gray-700 text-sm mb-2">
                    Use the pound symbol (#) to switch between agents:
                </p>
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <ul class="list-disc list-inside text-gray-700 text-sm space-y-1">
                        <li><code>#ID</code> - Switch to agent with the specified ID (e.g., <code>#1</code>)</li>
                        <li><code>#NAME</code> - Switch to agent by name (e.g., <code>#researcher</code>)</li>
                    </ul>
                </div>
                
                <h3 class="text-xl font-medium text-gray-900 mb-3">Interrupting Operations</h3>
                <p class="text-gray-700 text-sm mb-2">
                    Termineer provides a multi-level interrupt system:
                </p>
                <div class="bg-gray-50 rounded-lg p-4">
                    <ul class="list-disc list-inside text-gray-700 text-sm space-y-1">
                        <li><strong>Ctrl+C</strong> - Interrupt the current operation (tool execution or agent processing)</li>
                        <li><strong>Ctrl+C</strong> (pressed twice within 3 seconds) - Exit the application</li>
                        <li><strong>/interrupt</strong> - Command to explicitly interrupt the current agent</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
</div>
{% endblock %}